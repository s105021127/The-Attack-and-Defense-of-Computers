# Linux exploitation

- [Binary Security|Protection](#BinarySecurity)
- [Linux Binary Exploitation]
  - [Stack Buffer Overflow](#BufferOverview) 
  - [ROP(Return-oriented programming)](#ROP)
  - [Format String Vulnerability]
  - [Heap exploitation]

- [Linux kernel Exploitation]


## 教科書

- [CTF 大賽 PWN 奪旗技術大展  吳石 審校，楊超 編著](https://www.tenlong.com.tw/products/9789860776034) 
- [GITHUB原始碼](https://github.com/firmianay/ctf-book)
  - 09 格式化字串
  - 10 堆疊溢位與ROP
  - 11 堆積(heap)利用
  - 12 Pwn 技巧


## BinarySecurity

- Stack Canaries
- No eXecute |the NX bit | Data Execution Prevention(DEP) 
- Relocation Read-Only (RELRO)
- [Address space layout randomization(ASLR)|[ Linux PaX project 2001]](https://en.wikipedia.org/wiki/Address_space_layout_randomization)


# Linux Binary Exploitation

- [Angelboy|AIS3 2017 Binary Exploitation](https://github.com/scwuaptx/AIS3-2017) [[PPT]](https://www.slideshare.net/AngelBoy1/binary-exploitation-ais3)
- [Angelboy|HITCON-Training|For Linux binary Exploitation](https://github.com/scwuaptx/HITCON-Training)
- [PWN2](https://www.youtube.com/watch?v=3vvYS09-IGA)
- [yuawn/NTU-Computer-Security-2019](https://github.com/yuawn/NTU-Computer-Security-2019)

- [Nightmare有很好的學習資料一定要去看看](https://guyinatuxedo.github.io/index.html)
  - 分門別類列出分析與解答 
- [CTF101: Binary Exploitation](https://ctf101.org/binary-exploitation/overview/)
- [ctf-all-in-one|PWN](https://firmianay.gitbooks.io/ctf-all-in-one/content/doc/3_topics.html)
- [CTF-wiki](http://ctfwiki.ycdxsb.cn/pwn/readme-zh/)
- [ctf-wiki/ctf-challenges](https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/stackoverflow)
- [bi0s wiki:PWN](https://wiki.bi0s.in/pwning/roadmap/)

- [Modern Binary Exploitation - CSCI 4968(2015)](https://github.com/RPISEC/MBE)
- [PWN.COLLEGE](https://pwn.college/) [[YOUTUBE頻道]](https://www.youtube.com/channel/UCBaWwFw7KmCN8YlfX4ERYKg)
  - [DEF CON CTF主辦人在HITCON CTF論壇，首度公開PWN College開源課程 2019 ithome](https://www.ithome.com.tw/news/134838) 


- [pwnable.kr](https://pwnable.kr/) 
- [pwnable.tw(請勿公開flag)](https://pwnable.tw/)

## BufferOverview
### 參考資料
- [Linux Binary Exploitation - Stack buffer overflow(Angelboy PPT 2018)](https://www.slideshare.net/AngelBoy1/linux-binary-exploitation-stack-buffer-overflow)

### 攻擊類型
- simple BufferOverview
- ret2code/ret2text
  - bamboofox/ret2text  
- ret2shellcode
- ret2libc(1997 Solar Designer)

## ROP
### 參考資料
- [Linux Binary Exploitation - Return-oritend Programing(Angelboy PPT 2018)](https://www.slideshare.net/AngelBoy1/linux-binary-exploitation-returnoritend-programing)
- [Binary Exploitation - ROP/FMT](https://www.youtube.com/watch?v=eVByV-8AumA)
- [ROP(Return-oriented programming)](https://en.wikipedia.org/wiki/Return-oriented_programming)
- [64-bit Linux Return-Oriented Programming](https://crypto.stanford.edu/~blynn/rop/)
- [ROP Emporium](https://ropemporium.com/)
- [ROP 輕鬆談(2014)](https://www.slideshare.net/hackstuff/rop-40525248)
- [pwnlib.rop — Return Oriented Programming](https://docs.pwntools.com/en/stable/rop.html)
### 攻擊類型
- ret2csu
  - [ret2csu](https://wiki.wgpsec.org/knowledge/ctf/ret2csu.html) 
- ret2reg
  - Ret2reg==攻擊繞過ASLR，返回到register位址
  - [ret2reg:Using Registers to bypass ASLR](https://ir0nstone.gitbook.io/notes/types/stack/reliable-shellcode/ret2reg)
  - [ROP-Ret2reg详解](https://cloud.tencent.com/developer/article/1740171)
- ret2syscall
  - [ret2syscall原理详解与实例分析](https://www.freebuf.com/articles/system/234228.html) 
  - [栈溢出之ret2syscall](http://uuzdaisuki.com/2020/02/25/%E6%A0%88%E6%BA%A2%E5%87%BA%E4%B9%8Bret2syscall/)
  - [ret2syscall](https://wiki.wgpsec.org/knowledge/ctf/ret2syscall.html)
- Stack migration
  - [CSAW CTF 2015/autobots](http://bruce30262.logdown.com/posts/301623-csaw-ctf-2015-autobots)
- ret2dl_resolve
  - [Return to dlresolve(Angelboy PPT 2015)](https://www.slideshare.net/AngelBoy1/re2dlresolve)
  - [0CTF/TCTF 2018 Quals/babystack](https://gist.github.com/ricardo2197/8c7f6f5b8950ed6771c1cd3a116f7e62)
- ret2VDSO
  - VDSO(Virtual Dynamically-linked Shared Object) 
- Jump-oriented programming(JOP)|2011
- [Pure-Call Oriented Programming(PCOP)|2017](https://www.researchgate.net/publication/317177008_Pure-Call_Oriented_Programming_PCOP_chaining_the_gadgets_using_call_instructions)
- [Sigreturn-oriented programming (SROP)2014](https://en.wikipedia.org/wiki/Sigreturn-oriented_programming)
  - [Sigreturn Oriented Programming(Angelboy PPT 2015)](https://www.slideshare.net/AngelBoy1/sigreturn-ori)
- [Blind return oriented programming (BROP)2014](https://en.wikipedia.org/wiki/Blind_return_oriented_programming)
  - http://www.scs.stanford.edu/brop/
  - https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/medium-rop-zh/#blind-rop
## Format String Vulnerability
### 攻擊類型
- Format String
- arbitrary memory|READ
- arbitrary memory|Write
- Advanced Topics


## Heap
- heap
- glibc library| functions ==> free(), malloc(), 
- Bins and Chunks
- GLIBC Heap Implementation ==> Glibc memory allocator 

### 參考資料
>* [Understanding glibc malloc](https://sploitfun.wordpress.com/2015/02/10/understanding-glibc-malloc/comment-page-1/?blogsub=confirming#subscribe-blog%E3%80%82) [中文版](https://blog.csdn.net/think_ycx/article/details/77160286)
>* [《gblic記憶體管理——ptmalloc2原始程式碼分析》](http://www.valleytalk.org/wp-content/uploads/2015/02/glibc%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86ptmalloc%E6%BA%90%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%901.pdf)
>* [r2Con2016 Glibc Heap Analysis with radare2 ](https://www.youtube.com/watch?v=Svm5V4leEho)

## Heap Exploitation
### 參考資料
- [Linux Binary Exploitation - Heap Exploitation(Angelboy PPT 2018)](https://www.slideshare.net/AngelBoy1/linux-binary-exploitation-heap-exploitation)
- [heap-exploitation](https://heap-exploitation.dhavalkapil.com/)
- [Shellphish|how2heap|Educational Heap Exploitation](https://github.com/shellphish/how2heap)
- [Binary Exploitation - HEAP](https://www.youtube.com/watch?v=FieppxsupDc)
- [Binary Exploitation - Advanced Heap Exploitation](https://www.youtube.com/watch?v=hd9z2_-ZVzw)
- [PWN3](https://www.youtube.com/watch?v=HSbPcTHqf1c)

### 攻擊類型
- Use after free attack
- Double free attack
- Fastbin attack
- large bin attack
- Unsortbin attack

## TCACHE
- TCACHE  per-thread cache| thread local caching
  - glibc 2.26(2017年)[Ubuntu 17.10]新增的優化技術, 預設為開啟
  - 該優化能增快malloc速度:為每個執行緒創建一個緩存（cache），從而實現無鎖的分配演算法，有不錯的性能提升
  - 具體上是減少了_int_malloc()的呼叫次數。
- references 
  - [libc2.26 之後的 Tcache 機制](https://www.jianshu.com/p/3ef98e86a913)

## TCACHE exploitation
### 參考資料
- [Tcache Exploitation(Angelboy PPT 2019)](https://www.slideshare.net/AngelBoy1/tcache-exploitation-127268389)

### 攻擊類型
- tcache dup(Double Free )
- [tcache_overlapping_chunks](https://kknews.cc/code/95xqlrj.html)
- tcache poisoning

## File exploitation
- FILE structures  , fread/fwrite/fopen/fclose , Glibc  file stream
- [(NTU CSIE Cpmputer Security 2018 Fall) Play with FILE Structure - I](https://www.youtube.com/watch?v=_ZnnGZygnzE)
- [(NTU CSIE Cpmputer Security 2018 Fall) Play with FILE Structure - II](https://www.youtube.com/watch?v=W99OuDK7Quo)
- [Play with FILE Structure - Yet Another Binary Exploit Technique(Angelboy PPT 2017)](https://www.slideshare.net/AngelBoy1/play-with-file-structure-yet-another-binary-exploit-technique)
- [File Stream Oriented Programming(FSOP)](https://gsec.hitb.org/materials/sg2018/WHITEPAPERS/FILE%20Structures%20-%20Another%20Binary%20Exploitation%20Technique%20-%20An-Jie%20Yang.pdf)


# Linux kernel Exploitation



# Others
## Race Condition
## interger overflow
## GOT hijacking
- [Execution(Angelboy PPT 2015)](https://www.slideshare.net/AngelBoy1/execution-50215114)


